<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‘‘å®šçµæœ - Salon de SÃ©rafina</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="ç¥è¨—ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹ã‚ãªãŸã¸ã®é‘‘å®šçµæœã€‚ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ãŒç¤ºã™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨å…·ä½“çš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ãŠå±Šã‘ã—ã¾ã™ã€‚">
    <meta name="keywords" content="é‘‘å®šçµæœ, ã‚¿ãƒ­ãƒƒãƒˆ, ç¥è¨—ã‚·ã‚¹ãƒ†ãƒ , å ã„çµæœ, ã‚»ãƒ©ãƒ•ã‚£ãƒŠ">
    
    <link rel="stylesheet" href="css/oracle-style.css">
    <style>
        .additional-question {
            background: rgba(255, 255, 255, 0.06);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin: 30px 0;
            text-align: center;
            backdrop-filter: blur(8px);
        }
        .additional-question h3 {
            color: #ffd700;
            margin-bottom: 12px;
        }
        .additional-question .offer-box {
            background: rgba(255, 215, 0, 0.12);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 14px;
        }
        .additional-question .time-limit { color: #ffd700; font-weight: bold; }
        .additional-question .price { font-weight: bold; }
        .additional-question button {
            background: linear-gradient(45deg, #ffd700, #ffb347, #ffd700);
            background-size: 300% 300%;
            color: #1a0033;
            padding: 12px 24px;
            border: none;
            border-radius: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.25s;
            box-shadow: 0 0 18px rgba(255, 215, 0, 0.55);
            margin: 8px 0 14px 0;
        }
        .additional-question button:hover {
            transform: translateY(-2px);
            box-shadow: 0 18px 32px rgba(255, 215, 0, 0.75);
        }
        .additional-question .how-to { font-size: 0.95em; color: rgba(255,255,255,0.9); }
        .additional-question .how-to ol { display: inline-block; text-align: left; margin: 6px 0 0; }
        @media (max-width: 768px) {
            .additional-question { padding: 18px; }
        }
    </style>
</head>
<body>
    <!-- ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ -->
    <nav class="breadcrumb">
        <a href="../omikuji/index.html">ğŸ  ãƒˆãƒƒãƒ—</a>
        <span class="breadcrumb-separator">â€º</span>
        <a href="tarot-detail.html">ç¥è¨—ã‚·ã‚¹ãƒ†ãƒ ã‚¿ãƒ­ãƒƒãƒˆå ã„</a>
        <span class="breadcrumb-separator">â€º</span>
        <span class="breadcrumb-current">é‘‘å®šçµæœ</span>
    </nav>

    <div class="container">
        <header class="result-header">
            <h1>ğŸ”® ã‚ãªãŸã¸ã®ç¥è¨—</h1>
            <p class="result-subtitle">ç¥è¨—ã‚·ã‚¹ãƒ†ãƒ ãŒå°ãå‡ºã—ãŸã‚ãªãŸã ã‘ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</p>
            <div class="user-info">
                <span id="user-name"></span>ã•ã‚“ã¸ã®é‘‘å®šçµæœ
            </div>
        </header>

        <section class="consultation-summary">
            <h2>ğŸ“ ã”ç›¸è«‡å†…å®¹</h2>
            <div class="consultation-display" id="consultation-display"></div>
        </section>
        
        <section class="cards-section">
            <h2><img src="images/card-back-1.jpg" alt="ã‚«ãƒ¼ãƒ‰" style="width: 24px; height: 40px; object-fit: cover; border-radius: 3px; vertical-align: middle; margin-right: 8px;"> é¸ã°ã‚ŒãŸã‚«ãƒ¼ãƒ‰</h2>
            <div id="cards-display" class="cards-container">
                <!-- ã‚«ãƒ¼ãƒ‰ãŒJavaScriptã§å‹•çš„ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </section>

        <section class="reading-section">
            <h2>âœ¨ ç¥è¨—ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</h2>
            <div id="reading-text" class="reading-content">
                <!-- é‘‘å®šçµæœãŒJavaScriptã§å‹•çš„ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </section>

        <section class="action-steps">
            <h2>ğŸ¯ å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³</h2>
            <div id="action-plan" class="action-content">
                <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ãŒJavaScriptã§å‹•çš„ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </section>

        <!-- è¿½åŠ è³ªå•ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
        <div class="additional-question">
            <h3>ğŸ’­ ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¸</h3>
            
            <div class="offer-box">
                <h4 style="color: #ffd700; margin-bottom: 10px; font-size: 1.2em;">ã€è¿½åŠ è³ªå•ã‚µãƒ¼ãƒ“ã‚¹ã€‘</h4>
                <p style="margin-bottom: 8px;">ã“ã®é‘‘å®šçµæœã«ã¤ã„ã¦ã•ã‚‰ã«è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¸</p>
                <p class="price" style="font-size: 1.1em; margin-bottom: 15px;">1å›<span style="color: #ffd700; font-weight: bold; font-size: 1.2em;">500å††</span>ã§è¿½åŠ è³ªå•ã‚’æ‰¿ã‚Šã¾ã™</p>
            </div>
            
            <div class="how-to" style="margin-bottom: 20px;">
                <p style="font-weight: bold; margin-bottom: 10px;">â–¼ã”åˆ©ç”¨æ–¹æ³•</p>
                <ol style="text-align: left; display: inline-block; margin: 0;">
                    <li>æ±ºæ¸ˆãƒšãƒ¼ã‚¸ã§ãŠæ”¯æ‰•ã„ï¼ˆ500å††ï¼‰</li>
                    <li>æ±ºæ¸ˆå®Œäº†ç”»é¢ã‚’ã‚¹ã‚¯ã‚·ãƒ§</li>
                    <li>LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸é€ä¿¡</li>
                    <li>è¿½åŠ è³ªå•ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãŠé€ã‚Šã—ã¾ã™</li>
                    <li><span style="color: #ffd700; font-weight: bold;">1é€±é–“ä»¥å†…ã«å›ç­”</span></li>
                </ol>
            </div>
            
            <button onclick="location.href='https://square.link/u/Tp6cc26W'" style="margin-bottom: 15px;">
                ğŸ“ è¿½åŠ è³ªå•ã‚’ç”³ã—è¾¼ã‚€
            </button>
            
            <div style="
                background: rgba(255, 215, 0, 0.1);
                border: 1px solid rgba(255, 215, 0, 0.4);
                border-radius: 10px;
                padding: 12px;
                font-size: 0.9em;
            ">
                <p style="color: #ffd700; font-weight: bold; margin: 0;">
                    â€»æ±ºæ¸ˆå¾Œã¯å¿…ãšLINEã§ã”é€£çµ¡ãã ã•ã„
                </p>
            </div>
        </div>

        <!-- å€‹äººé‘‘å®šã¸ã®èª˜å° -->
        <div class="personal-upsell">
            <h3>ğŸŒŸ ã‚‚ã£ã¨æ·±ãçŸ¥ã‚ŠãŸã„æ–¹ã¸</h3>
            <p>ã‚·ã‚¹ãƒ†ãƒ é‘‘å®šã§ã¯ç‰©è¶³ã‚Šãªã„æ–¹ã¯ã€ã‚»ãƒ©ãƒ•ã‚£ãƒŠãŒç›´æ¥é‘‘å®šã™ã‚‹å€‹äººé‘‘å®šã‚’ã©ã†ã</p>
            <button class="personal-upsell-btn" onclick="location.href='../personal-reading-detail.html'">
                âœ¨ å€‹äººé‘‘å®šã®è©³ç´°ã‚’è¦‹ã‚‹
            </button>
        </div>

        <section class="feedback-section">
            <h2>ğŸ“ é‘‘å®šã¯ã„ã‹ãŒã§ã—ãŸã‹ï¼Ÿ</h2>
            <div class="feedback-buttons">
                <button class="feedback-btn satisfied" onclick="submitFeedback('satisfied')">
                    ğŸ˜Š ã¨ã¦ã‚‚æº€è¶³
                </button>
                <button class="feedback-btn good" onclick="submitFeedback('good')">
                    ğŸ‘ æº€è¶³
                </button>
                <button class="feedback-btn normal" onclick="submitFeedback('normal')">
                    ğŸ˜ æ™®é€š
                </button>
            </div>
            <p class="feedback-thanks" id="feedback-thanks" style="display: none;">
                âœ¨ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼
            </p>
        </section>

        <div class="navigation-buttons">
            <a href="tarot-detail.html" class="nav-btn secondary">
                ğŸ”„ ã‚‚ã†ä¸€åº¦é‘‘å®šã™ã‚‹
            </a>
            <a href="../omikuji/index.html" class="nav-btn primary">
                ğŸ  ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
            </a>
        </div>
    </div>
    
    <script src="js/tarot-cards.js"></script>
    <script src="js/oracle-system.js"></script>
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«é‘‘å®šçµæœã‚’è¡¨ç¤º
        document.addEventListener('DOMContentLoaded', function() {
            displayReading();
        });

        function displayReading() {
            console.log('ğŸ¯ é‘‘å®šçµæœãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ä¸­...');
            const consultationData = JSON.parse(localStorage.getItem('consultationData') || '{}');
            console.log('ğŸ“‹ ç›¸è«‡ãƒ‡ãƒ¼ã‚¿ç¢ºèª:', consultationData);
            
            if (!consultationData.name) {
                console.error('âŒ ç›¸è«‡ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                alert('é‘‘å®šãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚');
                window.location.href = 'tarot-detail.html';
                return;
            }

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤º
            console.log('ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¡¨ç¤º:', consultationData.name);
            document.getElementById('user-name').textContent = consultationData.name;
            document.getElementById('consultation-display').textContent = consultationData.consultation;

            // ç¥è¨—ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹é‘‘å®šå®Ÿè¡Œ
            console.log('ğŸ”® ç¥è¨—ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆæœŸåŒ–...');
            const oracle = new OracleSystem();
            
            // ãƒ†ã‚¹ãƒˆç”¨ï¼šã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ†ã‚¹ãƒˆå¯èƒ½ã«ã™ã‚‹
            window.oracleTest = oracle;
            console.log('ğŸ§ª ãƒ†ã‚¹ãƒˆç”¨: window.oracleTest ã§ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½');
            console.log('ğŸ”¬ APIå‹•ä½œç¢ºèªç”¨ã‚³ãƒãƒ³ãƒ‰:');
            console.log('   window.testAPI() - ç°¡å˜ãªAPIæ¥ç¶šãƒ†ã‚¹ãƒˆ');
            console.log('   window.testFullReading() - å®Œå…¨ãªé‘‘å®šãƒ†ã‚¹ãƒˆ');
            
            // APIå‹•ä½œç¢ºèªç”¨ã®ãƒ†ã‚¹ãƒˆé–¢æ•°ã‚’è¿½åŠ 
            window.testAPI = async function() {
                console.log('ğŸ§ª APIæ¥ç¶šãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                const testData = {
                    name: "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼",
                    consultation: "ä»Šå¾Œã®äººç”Ÿã«ã¤ã„ã¦ç›¸è«‡ãŒã‚ã‚Šã¾ã™ã€‚",
                    focusArea: "future",
                    birthdate: "1990-01-01"
                };
                
                try {
                    const result = await oracle.generateWithAPI(testData);
                    console.log('âœ… APIæ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸï¼', result);
                    return result;
                } catch (error) {
                    console.error('âŒ APIæ¥ç¶šãƒ†ã‚¹ãƒˆå¤±æ•—:', error);
                    return null;
                }
            };
            
            window.testFullReading = async function() {
                console.log('ğŸ”® å®Œå…¨é‘‘å®šãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                const testData = {
                    name: "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼",
                    consultation: "æ‹æ„›ã«ã¤ã„ã¦æ‚©ã‚“ã§ã„ã¾ã™ã€‚ä»Šã®é–¢ä¿‚ã‚’ã©ã†é€²ã‚ã¦ã„ã‘ã°ã„ã„ã§ã—ã‚‡ã†ã‹ã€‚",
                    focusArea: "love",
                    birthdate: "1990-06-15"
                };
                
                try {
                    const result = await oracle.generateReading(testData);
                    console.log('âœ… å®Œå…¨é‘‘å®šãƒ†ã‚¹ãƒˆå®Œäº†ï¼');
                    console.log('ğŸ“Š é‘‘å®šçµæœ:', result);
                    console.log('ğŸ“ é‘‘å®šæ–‡å­—æ•°:', result.reading.length);
                    console.log('ğŸƒ é¸ã°ã‚ŒãŸã‚«ãƒ¼ãƒ‰:', result.cards.map(c => c.name));
                    return result;
                } catch (error) {
                    console.error('âŒ å®Œå…¨é‘‘å®šãƒ†ã‚¹ãƒˆå¤±æ•—:', error);
                    return null;
                }
            };
            
            console.log('â³ é‘‘å®šã‚’é–‹å§‹ã—ã¾ã™...');
            oracle.generateReading(consultationData).then(result => {
                console.log('âœ… é‘‘å®šå®Œäº†!', result);
                displayCards(result.cards);
                displayReadingText(result.reading);
                displayActionPlan(result.actionPlan);
            }).catch(error => {
                console.error('ğŸ’¥ é‘‘å®šå‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ:', error);
                alert('é‘‘å®šå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
            });
        }

        function displayCards(cards) {
            const cardsContainer = document.getElementById('cards-display');
            cardsContainer.innerHTML = cards.map(card => `
                <div class="card-item">
                    <div class="card-position">${card.position}</div>
                    <div class="card-image-container">
                        ${getCardImageHTML(card)}
                        ${card.isUpright ? '' : '<div class="reversed-indicator">é€†ä½ç½®</div>'}
                    </div>
                    <div class="card-name">${card.name}${card.isUpright ? '' : ' (é€†ä½ç½®)'}</div>
                    <div class="card-meaning">${card.meaning}</div>
                </div>
            `).join('');
        }

        function getCardImageHTML(card) {
            // ã‚«ãƒ¼ãƒ‰ç”»åƒãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ç”»åƒã‚’è¡¨ç¤ºã€ãã†ã§ãªã‘ã‚Œã°ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
            const imagePath = card.imagePath || `images/cards/${String(card.id).padStart(2, '0')}_${card.englishName.toLowerCase().replace(/\s+/g, '_')}.jpg`;
            
            return `
                <img 
                    src="${imagePath}" 
                    alt="${card.name}" 
                    class="card-image"
                    onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                >
                <div class="card-image-fallback" style="display: none;">
                    <img src="images/card-back-1.jpg" alt="ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                </div>
            `;
        }

        function displayReadingText(reading) {
            const readingContainer = document.getElementById('reading-text');
            readingContainer.innerHTML = `
                <div class="reading-paragraph">
                    ${reading.split('\n').map(p => p.trim() ? `<p>${p}</p>` : '').join('')}
                </div>
            `;
        }

        function displayActionPlan(actionPlan) {
            const actionContainer = document.getElementById('action-plan');
            actionContainer.innerHTML = `
                <div class="action-list">
                    ${actionPlan.map(action => `
                        <div class="action-item">
                            <div class="action-icon">âœ¨</div>
                            <div class="action-text">${action}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function submitFeedback(rating) {
            const feedbackThanks = document.getElementById('feedback-thanks');
            feedbackThanks.style.display = 'block';
            
            // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            const buttons = document.querySelectorAll('.feedback-btn');
            buttons.forEach(btn => btn.disabled = true);

            // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ï¼ˆå®Ÿéš›ã®é‹ç”¨ã§ã¯é€ä¿¡ï¼‰
            const feedback = {
                rating: rating,
                timestamp: new Date().toISOString(),
                consultation: JSON.parse(localStorage.getItem('consultationData') || '{}')
            };
            
            localStorage.setItem('feedback', JSON.stringify(feedback));
        }

        // å€‹äººé‘‘å®šç”³ã—è¾¼ã¿
        document.getElementById('upgrade-btn').addEventListener('click', function() {
            alert('å€‹äººé‘‘å®šã®ãŠç”³è¾¼ã¿ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã€‚\nå®Ÿéš›ã®é‹ç”¨æ™‚ã¯æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ ã«æ¥ç¶šã•ã‚Œã¾ã™ã€‚');
            // å®Ÿéš›ã®é‹ç”¨æ™‚ã¯å€‹äººé‘‘å®šã®ç”³ã—è¾¼ã¿ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
            // window.location.href = 'personal-reading-order.html';
        });
    </script>
</body>
</html>
